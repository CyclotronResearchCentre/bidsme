# --------------------------------------------------------------------------------
# This is a bidsmap YAML file with the key-value mappings for the different BIDS
# modalities (anat, func, dwi, etc). The modality attributes are the keys that map
# onto the BIDS labels. The bidsmap data-structure should be 5 levels deep:
# dict > dict > list > dict > dict
#
# NB:
# 1) Edit the bidsmap file to your needs before feeding it to bidscoiner.py
# 2) (Institute) users may create their own bidsmap_[template].yaml or
#    bidsmap_[sample].yaml file
#
# For more information, see:
# https://github.com/Donders-Institute/bidscoin
# https://docs.ansible.com/ansible/latest/reference_appendices/YAMLSyntax.html
# --------------------------------------------------------------------------------


Options:
  version: '2.3.1'
  bidsignore: extra_data/ 


PlugIns:
  path: ~
  options: ~

MRI:
  Nifti_dump:
    anat:
    - provenance: ~
      attributes: &anatattributes
        Modality: ~
        ProtocolName: ['t1.*', '.*mtflash3d_T1w.*'] 
        SeriesDescription: ~
        ImageType: ~
        SequenceName: ~
        SequenceVariant: ~
        ScanningSequence: ~
        MRAcquisitionType: ~
        SliceThickness: ~
        FlipAngle: ~
        EchoNumbers: ~
        EchoTime: ~
        RepetitionTime: ~
      bids: &anatbids
        acq: ~
        ce: ~
        rec: ~
        run: <<1>>
        mod: ~
      suffix: T1w
    - provenance: ~
      attributes: 
        <<: *anatattributes
        ProtocolName: 'localizer'
      bids:
        <<: *anatbids
      suffix: localizer
    - provenance: ~
      attributes: 
        <<: *anatattributes
        ProtocolName: 't2_spc_da-fl_sag_p2_iso'
      bids:
        <<: *anatbids
      suffix: FLAIR

    func:
    - provenance: ~
      attributes: 
        Modality: ~
        ProtocolName: '.*_bold_.*_invertpe'
        SeriesDescription: ~
        ImageType: '.*MOSAIC'
        SequenceName: ~
        SequenceVariant: ~
        ScanningSequence: ~
        MRAcquisitionType: ~
        SliceThickness: ~
        FlipAngle: ~
        EchoNumbers: ~
        EchoTime: ~
        RepetitionTime: ~
      bids: &funcbids
        task: <SeriesDescription>
        acq: ~
        ce: ~
        dir: PE
        rec: ~
        run: <<1>>
        echo: <EchoNumbers>
      suffix: BOLD

    - provenance: ~
      attributes: 
        Modality: ~
        ProtocolName: '.*_bold_.*'
        SeriesDescription: ~
        ImageType: '.*MOSAIC'
        SequenceName: ~
        SequenceVariant: ~
        ScanningSequence: ~
        MRAcquisitionType: ~
        SliceThickness: ~
        FlipAngle: ~
        EchoNumbers: ~
        EchoTime: ~
        RepetitionTime: ~
      bids: 
        task: <SeriesDescription>
        acq: ~
        ce: ~
        dir: EP
        rec: ~
        run: <<1>>
        echo: <EchoNumbers>
      suffix: BOLD
    dwi:
    - provenance: ~
      attributes: 
        Modality: ~
        ProtocolName: '.*_diff_.*_invertpe'
        SeriesDescription: ~
        ImageType: ~
        SequenceName: ~
        SequenceVariant: ~
        ScanningSequence: ~
        MRAcquisitionType: ~
        SliceThickness: ~
        FlipAngle: ~
        EchoNumbers: ~
        EchoTime: ~
        RepetitionTime: ~
      bids: 
        acq: ~
        dir: EP
        run: <<1>>
      suffix: dwi
    - provenance: ~
      attributes: 
        Modality: ~
        ProtocolName: '.*_diff_.*'
        SeriesDescription: ~
        ImageType: ~
        SequenceName: ~
        SequenceVariant: ~
        ScanningSequence: ~
        MRAcquisitionType: ~
        SliceThickness: ~
        FlipAngle: ~
        EchoNumbers: ~
        EchoTime: ~
        RepetitionTime: ~
      bids: 
        acq: ~
        dir: PE
        run: <<1>>
      suffix: dwi
    fmap:
    - provenance: ~
      attributes: &fmapattributes
        Modality: ~
        ProtocolName: 'gre_field_mapping'
        SeriesDescription: ~
        ImageType: 'ORIGINAL\\PRIMARY\\M\\ND'
        SequenceName: ~
        SequenceVariant: ~
        ScanningSequence: ~
        MRAcquisitionType: ~
        SliceThickness: ~
        FlipAngle: ~
        EchoNumbers: 1
        EchoTime: ~
        RepetitionTime: ~
      bids: &fmapbids
        acq: <SeriesDescription>
        ce: ~
        dir: ~
        run: <<1>>
      suffix: magnitude1
    - provenance: ~
      attributes: 
        <<: *fmapattributes
        EchoNumbers: 2
      bids:
        <<: *fmapbids
      suffix: magnitude2
    - provenance: ~
      attributes: 
        <<: *fmapattributes
        ImageType: 'ORIGINAL\\PRIMARY\\P\\ND '
        EchoNumbers: 1
      bids:
        <<: *fmapbids
      suffix: phase1
    - provenance: ~
      attributes: 
        <<: *fmapattributes
        ImageType: 'ORIGINAL\\PRIMARY\\P\\ND '
        EchoNumbers: 2
      bids:
        <<: *fmapbids
      suffix: phase2
    beh:
    - provenance: ~
      attributes: &behattributes
        Modality: ~
        ProtocolName: ~
        SeriesDescription: ~
        ImageType: ~
        SequenceName: ~
        SequenceVariant: ~
        ScanningSequence: ~
        MRAcquisitionType: ~
        SliceThickness: ~
        FlipAngle: ~
        EchoNumbers: ~
        EchoTime: ~
        RepetitionTime: ~
      bids: &behbids
        task: <SeriesDescription>
      suffix: events
    - provenance: ~
      attributes: *behattributes
      bids:
        <<: *behbids
      suffix: beh
    - provenance: ~
      attributes: *behattributes
      bids:
        <<: *behbids
      suffix: physio
    - provenance: ~
      attributes: *behattributes
      bids:
        <<: *behbids
      suffix: stim

    pet:
    - provenance: ~
      attributes: &petattributes
        Modality: PT
        SeriesDescription: ~
        Radiopharmaceutical: ~
        ImageType: ~
        SliceThickness: ~
        PixelSpacing: ~
        Rows: ~
        Columns: ~
      bids: &petbids
        task: <SeriesDescription>
        acq: <Radiopharmaceutical>
        rec: ~
        run: <<1>>
      suffix: pet

    extra_data:
    - provenance: ~
      attributes:
        Modality: ~
        ProtocolName: ~
        SeriesDescription: ~
        ImageType: ~
        SequenceName: ~
        SequenceVariant: ~
        ScanningSequence: ~
        MRAcquisitionType: ~
        SliceThickness: ~
        FlipAngle: ~
        EchoNumbers: ~
        EchoTime: ~
        RepetitionTime: ~
        PhaseEncodingDirection: ~
      bids:
        acq: <SeriesDescription>
        rec: ~
        ce: ~
        task: ~
        echo: <EchoNumbers>
        dir: <InPlanePhaseEncodingDirection>
        run: <<1>>
        mod: ~
      suffix: ~

    leave_out:
    - provenance: ~
      attributes:
        Modality: ~
        ProtocolName: ~
        SeriesDescription: ~
        ImageType: ~
        SequenceName: ~
        SequenceVariant: ~
        ScanningSequence: ~
        MRAcquisitionType: ~
        SliceThickness: ~
        FlipAngle: ~
        EchoNumbers: ~
        EchoTime: ~
        RepetitionTime: ~
        PhaseEncodingDirection: ~
      bids:
        acq: <SeriesDescription>
        rec: ~
        ce: ~
        task: ~
        echo: <EchoNumbers>
        dir: <InPlanePhaseEncodingDirection>
        run: <<1>>
        mod: ~
      suffix: ~

